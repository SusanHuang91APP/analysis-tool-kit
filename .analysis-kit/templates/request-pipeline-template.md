# __NAME__ - Request Pipeline Analysis

> **ğŸ¯ åˆ†æå“è³ª**ï¼šâ­ åŸºç¤æ¡†æ¶ (0%)  
> **ğŸ“… é–‹å§‹æ—¥æœŸ**ï¼š__CURRENT_DATE__  
> **ğŸ“… æœ€å¾Œæ›´æ–°**ï¼š__CURRENT_DATE__  
> **ğŸ“Š åˆ†æéšæ®µ**ï¼šğŸ“ å¾…åˆ†æ  
> **ğŸ”— ç›¸é—œæ–‡ä»¶**ï¼š[é€£çµåˆ° shared/overview.md](../overview.md)

---

## 1. ğŸ“ æ ¸å¿ƒæ‘˜è¦èˆ‡ä¾è³´ (Core Summary & Dependencies)

### 1.1 ğŸ“‚ åˆ†ææª”æ¡ˆè³‡è¨Š (Analyzed Files)

| æª”æ¡ˆè·¯å¾‘ |
|---------|
| [å¾…è£œå……ï¼šè¢«åˆ†æçš„åŸå§‹æª”æ¡ˆå®Œæ•´è·¯å¾‘] |

### 1.2 ğŸ“¦ ä¾è³´é—œä¿‚ (Dependencies)

| é¡å‹ | åç¨± | ç”¨é€” | æª”æ¡ˆé€£çµ |
|------|------|------|----------|
| Service | [æœå‹™åç¨±] | [æœå‹™ç”¨é€”] | [åˆ†ææ–‡ä»¶é€£çµ] |
| Helper | [å·¥å…·åç¨±] | [å·¥å…·ç”¨é€”] | [åˆ†ææ–‡ä»¶é€£çµ] |

**èªªæ˜ï¼š** æ­¤è¡¨æ ¼è¿½è¹¤æœ¬ Pipeline å…ƒä»¶ä¾è³´çš„æ‰€æœ‰å¤–éƒ¨æœå‹™èˆ‡å·¥å…·ã€‚

---

## 2. ğŸ“‹ åˆ†ææŒ‡å¼• (Analysis Guidelines)

**æ­¤æ–‡ä»¶çš„åˆ†æç›®æ¨™ï¼š**

æœ¬æ–‡ä»¶ç”¨æ–¼åˆ†æ**è«‹æ±‚ç®¡ç·šå…ƒä»¶ï¼ˆFilter/Middlewareï¼‰**ï¼Œé‡é»åœ¨æ–¼ï¼š

1. **åŸ·è¡Œæ™‚æ©Ÿ**ï¼šè¨˜éŒ„åœ¨è«‹æ±‚/å›æ‡‰ç®¡ç·šä¸­çš„åŸ·è¡Œé †åºå’Œè§¸ç™¼æ¢ä»¶
2. **è™•ç†é‚è¼¯**ï¼šåˆ†ææ””æˆªé‚è¼¯ã€çŸ­è·¯æ¢ä»¶ã€å›æ‡‰ä¿®æ”¹
3. **é©ç”¨ç¯„åœ**ï¼šèªªæ˜å¥—ç”¨åœ¨å…¨åŸŸ/Controller/Action çš„ä¸åŒå ´æ™¯
4. **ä¾è³´è¿½è¹¤**ï¼šè¿½è¹¤ä¾è³´çš„ Service/Helperï¼Œå»ºç«‹ä¾è³´é—œä¿‚è¡¨
5. **æ•ˆèƒ½èˆ‡å®‰å…¨**ï¼šè©•ä¼°å°è«‹æ±‚çš„æ•ˆèƒ½å½±éŸ¿ã€æ‰¿æ“”çš„å®‰å…¨è²¬ä»»

**AI Agent æ³¨æ„äº‹é …ï¼š**
- æ­¤ç‚ºè«‹æ±‚ç®¡ç·šå…ƒä»¶åˆ†æï¼Œé—œæ³¨åœ¨æ¯å€‹ HTTP è«‹æ±‚ä¸­éƒ½æœƒåŸ·è¡Œçš„é‚è¼¯
- å¿…é ˆæ¸…æ¥šèªªæ˜åŸ·è¡Œé †åºï¼ˆOrderï¼‰å’ŒçŸ­è·¯æ¢ä»¶
- å¿…é ˆç”¨æµç¨‹åœ–å±•ç¤ºè«‹æ±‚ â†’ æª¢æŸ¥ â†’ æ±ºç­– â†’ ç¹¼çºŒ/çŸ­è·¯ çš„é‚è¼¯
- é‡é»é—œæ³¨æ•ˆèƒ½å½±éŸ¿ï¼ˆæ¯å€‹è«‹æ±‚éƒ½æœƒåŸ·è¡Œï¼‰å’Œå®‰å…¨è²¬ä»»ï¼ˆæˆæ¬Šã€é©—è­‰ï¼‰
- å¿…é ˆæä¾›åœ¨ä¸åŒå±¤ç´šï¼ˆå…¨åŸŸ/Controller/Actionï¼‰å¥—ç”¨çš„ç¯„ä¾‹

---

## 3. Pipeline å…ƒä»¶è³‡è¨Š (Component Information)

### 3.1 å…ƒä»¶å®šç¾©

**åŸºæœ¬è³‡è¨Šï¼š**
- **å…ƒä»¶åç¨±**ï¼š[å¾…è£œå……]
- **æª”æ¡ˆè·¯å¾‘**ï¼š[å¾…è£œå……]
- **å…ƒä»¶é¡å‹**ï¼šğŸ” èªè­‰ / ğŸ›¡ï¸ æˆæ¬Š / ğŸ“ æ—¥èªŒ / ğŸ”„ è½‰æ› / âš¡ å¿«å–
- **åŸ·è¡Œéšæ®µ**ï¼šBefore Request / After Request / Both

---

### 3.2 è¨»å†Šæ–¹å¼èˆ‡é †åº

**è¨»å†Šæ–¹å¼ï¼š**
```csharp
// .NET MVC Filter
[AttributeName(Order = 1)]
public class ControllerName : Controller { }
```

æˆ–

```typescript
// Express Middleware
app.use(middlewareName);
```

**åŸ·è¡Œé †åºï¼š**
1. Middleware 1 (Order = 1)
2. Middleware 2 (Order = 2)
3. **æ­¤ Middleware** (Order = N)
4. Middleware N+1

---

### 3.3 é©ç”¨ç¯„åœ

**é©ç”¨ç›®æ¨™ï¼š**
- [ ] å…¨åŸŸï¼ˆæ‰€æœ‰è«‹æ±‚ï¼‰
- [ ] Controller å±¤ç´š
- [ ] Action å±¤ç´š
- [ ] ç‰¹å®šè·¯ç”±

**ç¯„åœèªªæ˜ï¼š**
[å¾…è£œå……ï¼šæè¿°æ­¤ Pipeline å…ƒä»¶çš„é©ç”¨ç¯„åœ]

---

## 4. åŸ·è¡Œé‚è¼¯ (Execution Logic)

### 4.1 è§¸ç™¼æ¢ä»¶

**è§¸ç™¼æ™‚æ©Ÿï¼š**
- [å¾…è£œå……ï¼šåœ¨ä»€éº¼æƒ…æ³ä¸‹è§¸ç™¼æ­¤ Pipeline]

**æ¢ä»¶åˆ¤æ–·ï¼š**
```typescript
if (condition) {
    // åŸ·è¡Œ Pipeline é‚è¼¯
}
```

---

### 4.2 è™•ç†æµç¨‹

**åŸ·è¡Œæ­¥é©Ÿï¼š**
1. **æ­¥é©Ÿ1**ï¼šæ¥æ”¶è«‹æ±‚/å›æ‡‰
2. **æ­¥é©Ÿ2**ï¼šåŸ·è¡Œæª¢æŸ¥/è½‰æ›
3. **æ­¥é©Ÿ3**ï¼šæ±ºå®šæ˜¯å¦ç¹¼çºŒ
4. **æ­¥é©Ÿ4**ï¼šå‚³éçµ¦ä¸‹ä¸€å€‹ Pipeline

**æµç¨‹åœ–ï¼š**
```mermaid
graph TD
    A[æ¥æ”¶è«‹æ±‚] --> B{æª¢æŸ¥æ¢ä»¶}
    B -->|ä¸ç¬¦åˆ| C[çŸ­è·¯è¿”å›]
    B -->|ç¬¦åˆ| D[åŸ·è¡Œè™•ç†]
    D --> E{è™•ç†çµæœ}
    E -->|æˆåŠŸ| F[å‚³éçµ¦ä¸‹ä¸€å€‹]
    E -->|å¤±æ•—| G[è¿”å›éŒ¯èª¤]
```

**é—œéµæ±ºç­–é»ï¼š**
- **æ±ºç­–1**ï¼š[å¾…è£œå……ï¼šæ¢ä»¶èˆ‡å½±éŸ¿]
- **æ±ºç­–2**ï¼š[å¾…è£œå……ï¼šæ¢ä»¶èˆ‡å½±éŸ¿]

---

### 4.3 çŸ­è·¯é‚è¼¯

**çŸ­è·¯æ¢ä»¶ï¼š**
[å¾…è£œå……ï¼šåœ¨ä»€éº¼æƒ…æ³ä¸‹æœƒçŸ­è·¯ï¼ˆä¸ç¹¼çºŒåŸ·è¡Œå¾ŒçºŒ Pipelineï¼‰]

**çŸ­è·¯å›æ‡‰ï¼š**
```csharp
// ç›´æ¥è¿”å›å›æ‡‰
return new JsonResult(new { error = "..." });
```

**çŸ­è·¯æµç¨‹ï¼š**
```mermaid
graph LR
    A[Pipeline æª¢æŸ¥] --> B{çŸ­è·¯æ¢ä»¶}
    B -->|æ˜¯| C[ç«‹å³è¿”å›]
    B -->|å¦| D[ç¹¼çºŒä¸‹ä¸€å€‹]
```

---

## 5. è«‹æ±‚/å›æ‡‰è™•ç† (Request/Response Handling)

### 5.1 è«‹æ±‚æ””æˆª

**æ””æˆªé‚è¼¯ï¼š**
```csharp
public override void OnActionExecuting(ActionExecutingContext context)
{
    // [å¾…è£œå……ï¼šè«‹æ±‚æ””æˆªé‚è¼¯]
    
    // æª¢æŸ¥æ¢ä»¶
    if (!isValid)
    {
        context.Result = new JsonResult(new { error = "..." });
        return;
    }
    
    base.OnActionExecuting(context);
}
```

**æ””æˆªè™•ç†ï¼š**
- **é©—è­‰1**ï¼š[å¾…è£œå……]
- **é©—è­‰2**ï¼š[å¾…è£œå……]

---

### 5.2 å›æ‡‰ä¿®æ”¹

**ä¿®æ”¹é‚è¼¯ï¼š**
```csharp
public override void OnActionExecuted(ActionExecutedContext context)
{
    // [å¾…è£œå……ï¼šå›æ‡‰ä¿®æ”¹é‚è¼¯]
    
    if (context.Result is JsonResult result)
    {
        // ä¿®æ”¹å›æ‡‰å…§å®¹
    }
    
    base.OnActionExecuted(context);
}
```

---

### 5.3 æ¨™é ­è™•ç†

**è«‹æ±‚æ¨™é ­è®€å–ï¼š**
```csharp
var header = context.HttpContext.Request.Headers["HeaderName"];
```

**å›æ‡‰æ¨™é ­è¨­å®šï¼š**
```csharp
context.HttpContext.Response.Headers.Add("HeaderName", "Value");
```

---

## 6. ä½¿ç”¨ç¯„ä¾‹ (Usage Examples)

### 6.1 åŸºæœ¬ä½¿ç”¨

```csharp
// å¥—ç”¨åœ¨ Controller
[PipelineName(Order = 1)]
public class MyController : Controller
{
    // ...
}
```

---

### 6.2 å¥—ç”¨åœ¨ Action

```csharp
// å¥—ç”¨åœ¨ç‰¹å®š Action
[PipelineName]
public ActionResult MyAction()
{
    // ...
}
```

---

### 6.3 çµ„åˆä½¿ç”¨

```csharp
// å¤šå€‹ Pipeline çµ„åˆ
[Pipeline1(Order = 1)]
[Pipeline2(Order = 2)]
[Pipeline3(Order = 3)]
public class MyController : Controller
{
    // ...
}
```

---

## 7. æ¶æ§‹èˆ‡å“è³ªåˆ†æ (Architecture & Quality Analysis)

### 7.1 æ•ˆèƒ½å½±éŸ¿è©•ä¼°

**æ•ˆèƒ½å½±éŸ¿ï¼š**
- **åŸ·è¡Œæ™‚é–“**ï¼š[å¾…è£œå……ï¼šå¹³å‡åŸ·è¡Œæ™‚é–“]
- **è³‡æºæ¶ˆè€—**ï¼š[å¾…è£œå……ï¼šCPU/è¨˜æ†¶é«”ä½¿ç”¨]

**æ•ˆèƒ½æª¢æŸ¥æ¸…å–®ï¼š**
- [ ] é¿å…é‡è¤‡è¨ˆç®—
- [ ] å¿«å–å¸¸ç”¨è³‡æ–™
- [ ] éåŒæ­¥è™•ç†ï¼ˆå¦‚é©ç”¨ï¼‰
- [ ] é¿å…é˜»å¡æ“ä½œ

**å„ªåŒ–å»ºè­°ï¼š**
- [å¾…è£œå……ï¼šå…·é«”çš„å„ªåŒ–æ–¹æ¡ˆ]

---

### 7.2 å®‰å…¨æ€§æª¢æŸ¥

**å®‰å…¨è²¬ä»»ï¼š**
[å¾…è£œå……ï¼šæ­¤ Pipeline åœ¨å®‰å…¨æ€§æ–¹é¢çš„è²¬ä»»]

**å®‰å…¨æª¢æŸ¥æ¸…å–®ï¼š**
- [ ] è¼¸å…¥é©—è­‰
- [ ] æˆæ¬Šæª¢æŸ¥
- [ ] SQL æ³¨å…¥é˜²è­·
- [ ] XSS é˜²è­·
- [ ] CSRF é˜²è­·

**å®‰å…¨é¢¨éšªï¼š**
- [å¾…è£œå……ï¼šå·²è­˜åˆ¥çš„å®‰å…¨é¢¨éšª]

---

### 7.3 éŒ¯èª¤è™•ç†

**éŒ¯èª¤è™•ç†ç­–ç•¥ï¼š**
```csharp
try
{
    // Pipeline é‚è¼¯
}
catch (Exception ex)
{
    // éŒ¯èª¤è™•ç†
    logger.Error(ex);
    context.Result = new JsonResult(new { error = "..." });
}
```

**éŒ¯èª¤é¡å‹ï¼š**
- `ExceptionType1` - [å¾…è£œå……ï¼šè™•ç†æ–¹å¼]
- `ExceptionType2` - [å¾…è£œå……ï¼šè™•ç†æ–¹å¼]

---

### 7.4 æ—¥èªŒè¨˜éŒ„

**æ—¥èªŒç­–ç•¥ï¼š**
- **è¨˜éŒ„æ™‚æ©Ÿ**ï¼š[å¾…è£œå……ï¼šä½•æ™‚è¨˜éŒ„æ—¥èªŒ]
- **æ—¥èªŒç­‰ç´š**ï¼šDebug / Info / Warning / Error
- **è¨˜éŒ„å…§å®¹**ï¼š[å¾…è£œå……ï¼šè¨˜éŒ„å“ªäº›è³‡è¨Š]

**æ—¥èªŒç¯„ä¾‹ï¼š**
```csharp
logger.Info($"Pipeline executed: {pipelineName}");
```

---

## 8. ğŸ“‹ å“è³ªæª¢æŸ¥æ¸…å–® (Quality Checklist)

### â­ åŸºç¤æ¡†æ¶ (1-40%)
- [ ] æ–‡ä»¶å…ƒæ•¸æ“šå®Œæ•´ï¼ˆæ—¥æœŸã€å“è³ªç­‰ç´šï¼‰
- [ ] å…ƒä»¶åŸºæœ¬è³‡è¨Šå®Œæ•´
- [ ] è¨»å†Šæ–¹å¼å·²èªªæ˜

### â­â­â­ é‚è¼¯å®Œæˆ (41-70%)
- [ ] åŸ·è¡Œæµç¨‹åœ–å·²ç¹ªè£½
- [ ] è§¸ç™¼æ¢ä»¶å·²å®šç¾©
- [ ] è™•ç†é‚è¼¯å·²èªªæ˜

### â­â­â­â­ æ¶æ§‹å®Œæ•´ (71-90%)
- [ ] **ä¾è³´é—œä¿‚è¡¨å·²å®Œæˆ**
- [ ] **æ‰€æœ‰ä¾è³´é …éƒ½å·²å»ºç«‹åˆ†ææª”æ¡ˆ**
- [ ] æ•ˆèƒ½å½±éŸ¿å·²è©•ä¼°
- [ ] å®‰å…¨æ€§æª¢æŸ¥å·²å®Œæˆ

### â­â­â­â­â­ å®Œæ•´åˆ†æ (91-100%)
- [ ] éŒ¯èª¤è™•ç†å®Œæ•´
- [ ] æ—¥èªŒç­–ç•¥æ˜ç¢º
- [ ] ä½¿ç”¨ç¯„ä¾‹å®Œæ•´
- [ ] å„ªåŒ–å»ºè­°å…·é«”

---

**ç•¶å‰å“è³ªç­‰ç´š**ï¼šâ­ åŸºç¤æ¡†æ¶ (0%)


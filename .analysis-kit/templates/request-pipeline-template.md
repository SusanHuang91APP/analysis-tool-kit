# __NAME__ - Request Pipeline Analysis

---

## 1. ðŸ“ æ ¸å¿ƒæ‘˜è¦èˆ‡ä¾è³´ (Core Summary & Dependencies)

### 1.1 ðŸ“‚ åˆ†æžæª”æ¡ˆè³‡è¨Š (Analyzed Files)

| æª”æ¡ˆè·¯å¾‘ |
|---------|
| [å¾…è£œå……ï¼šè¢«åˆ†æžçš„åŽŸå§‹æª”æ¡ˆå®Œæ•´è·¯å¾‘] |

### 1.2 ðŸ“¦ ä¾è³´é—œä¿‚ (Dependencies)

| é¡žåž‹ | åç¨± | ç”¨é€” | æª”æ¡ˆé€£çµ |
|------|------|------|----------|
| Service | [æœå‹™åç¨±] | [æœå‹™ç”¨é€”] | [åˆ†æžæ–‡ä»¶é€£çµ] |
| Helper | [å·¥å…·åç¨±] | [å·¥å…·ç”¨é€”] | [åˆ†æžæ–‡ä»¶é€£çµ] |

**èªªæ˜Žï¼š** æ­¤è¡¨æ ¼è¿½è¹¤æœ¬ Pipeline å…ƒä»¶ä¾è³´çš„æ‰€æœ‰å¤–éƒ¨æœå‹™èˆ‡å·¥å…·ã€‚

---

## 2. ðŸ“‹ åˆ†æžæŒ‡å¼• (Analysis Guidelines)

**åˆ†æžç›®æ¨™ï¼š**
åˆ†æžè«‹æ±‚ç®¡ç·šå…ƒä»¶ï¼ˆFilter/Middlewareï¼‰ã€‚å°ˆæ³¨ï¼šåŸ·è¡Œæ™‚æ©Ÿã€è™•ç†é‚è¼¯ã€é©ç”¨ç¯„åœã€ä¾è³´è¿½è¹¤ã€æ•ˆèƒ½èˆ‡å®‰å…¨ã€‚

**æ ¸å¿ƒè¦å‰‡ï¼š**
- ç« ç¯€çµæ§‹ä¸è®Šï¼šç¦æ­¢æ–°å¢žæˆ–åˆªé™¤é è¨­ç« ç¯€
- ä¾†æºæª”æ¡ˆé™å®šï¼šåªåˆ†æž 1.1 ç¯€åˆ—å‡ºçš„æª”æ¡ˆ
- ä¾è³´è¨»è¨˜ï¼šæœªåˆ†æžçš„ä¾è³´è¨˜éŒ„åœ¨ 1.2 ç¯€
- ç¨‹å¼ç¢¼çœŸå¯¦æ€§ï¼šç¦æ­¢ä½¿ç”¨ `...` çœç•¥æˆ–ç·¨é€ å…§å®¹
- å“è³ªæ¸…å–®ä¸è®Šï¼šåƒ…æ›´æ–°å‹¾é¸ç‹€æ…‹ `[ ]` -> `[x]`

---

## 3. Pipeline å…ƒä»¶è³‡è¨Š (Component Information)

### 3.1 å…ƒä»¶å®šç¾©

**åŸºæœ¬è³‡è¨Šï¼š**
- **å…ƒä»¶åç¨±**ï¼š[å¾…è£œå……]
- **æª”æ¡ˆè·¯å¾‘**ï¼š[å¾…è£œå……]
- **å…ƒä»¶é¡žåž‹**ï¼šðŸ” èªè­‰ / ðŸ›¡ï¸ æŽˆæ¬Š / ðŸ“ æ—¥èªŒ / ðŸ”„ è½‰æ› / âš¡ å¿«å–
- **åŸ·è¡ŒéšŽæ®µ**ï¼šBefore Request / After Request / Both

---

### 3.2 è¨»å†Šæ–¹å¼èˆ‡é †åº

**è¨»å†Šæ–¹å¼ï¼š**
```csharp
// .NET MVC Filter
[AttributeName(Order = 1)]
public class ControllerName : Controller { }
```

æˆ–

```typescript
// Express Middleware
app.use(middlewareName);
```

**åŸ·è¡Œé †åºï¼š**
1. Middleware 1 (Order = 1)
2. Middleware 2 (Order = 2)
3. **æ­¤ Middleware** (Order = N)
4. Middleware N+1

---

### 3.3 é©ç”¨ç¯„åœ

[å¾…è£œå……ï¼šèªªæ˜Žæ­¤ Pipeline å…ƒä»¶çš„é©ç”¨ç¯„åœ]

**é©ç”¨ç›®æ¨™ï¼š**
- [ ] å…¨åŸŸï¼ˆæ‰€æœ‰è«‹æ±‚ï¼‰
- [ ] Controller å±¤ç´š
- [ ] Action å±¤ç´š
- [ ] ç‰¹å®šè·¯ç”±

---

## 4. åŸ·è¡Œé‚è¼¯ (Execution Logic)

### 4.1 è§¸ç™¼æ¢ä»¶

[å¾…è£œå……ï¼šèªªæ˜Žè§¸ç™¼æ™‚æ©Ÿèˆ‡æ¢ä»¶åˆ¤æ–·]

**è§¸ç™¼æ™‚æ©Ÿï¼š**
- [å¾…è£œå……]

**æ¢ä»¶åˆ¤æ–·ï¼š**
```typescript
if (condition) {
    // åŸ·è¡Œ Pipeline é‚è¼¯
}
```

---

### 4.2 è™•ç†æµç¨‹

**åŸ·è¡Œæ­¥é©Ÿï¼š**
1. **æ­¥é©Ÿ1**ï¼šæŽ¥æ”¶è«‹æ±‚/å›žæ‡‰
2. **æ­¥é©Ÿ2**ï¼šåŸ·è¡Œæª¢æŸ¥/è½‰æ›
3. **æ­¥é©Ÿ3**ï¼šæ±ºå®šæ˜¯å¦ç¹¼çºŒ
4. **æ­¥é©Ÿ4**ï¼šå‚³éžçµ¦ä¸‹ä¸€å€‹ Pipeline

**æµç¨‹åœ–ï¼š**
```mermaid
graph TD
    A[æŽ¥æ”¶è«‹æ±‚] --> B{æª¢æŸ¥æ¢ä»¶}
    B -->|ä¸ç¬¦åˆ| C[çŸ­è·¯è¿”å›ž]
    B -->|ç¬¦åˆ| D[åŸ·è¡Œè™•ç†]
    D --> E{è™•ç†çµæžœ}
    E -->|æˆåŠŸ| F[å‚³éžçµ¦ä¸‹ä¸€å€‹]
    E -->|å¤±æ•—| G[è¿”å›žéŒ¯èª¤]
```

**é—œéµæ±ºç­–é»žï¼š**
- **æ±ºç­–1**ï¼š[å¾…è£œå……ï¼šæ¢ä»¶èˆ‡å½±éŸ¿]
- **æ±ºç­–2**ï¼š[å¾…è£œå……ï¼šæ¢ä»¶èˆ‡å½±éŸ¿]

---

### 4.3 çŸ­è·¯é‚è¼¯

[å¾…è£œå……ï¼šèªªæ˜ŽçŸ­è·¯æ¢ä»¶èˆ‡å›žæ‡‰æ–¹å¼]

**çŸ­è·¯å›žæ‡‰ï¼š**
```csharp
// ç›´æŽ¥è¿”å›žå›žæ‡‰
return new JsonResult(new { error = "..." });
```

**çŸ­è·¯æµç¨‹ï¼š**
```mermaid
graph LR
    A[Pipeline æª¢æŸ¥] --> B{çŸ­è·¯æ¢ä»¶}
    B -->|æ˜¯| C[ç«‹å³è¿”å›ž]
    B -->|å¦| D[ç¹¼çºŒä¸‹ä¸€å€‹]
```

---

## 5. è«‹æ±‚/å›žæ‡‰è™•ç† (Request/Response Handling)

### 5.1 è«‹æ±‚æ””æˆª

[å¾…è£œå……ï¼šèªªæ˜Žè«‹æ±‚æ””æˆªé‚è¼¯èˆ‡é©—è­‰è™•ç†]

**æ””æˆªé‚è¼¯ï¼š**
```csharp
// [å¾…è£œå……ï¼šè²¼ä¸Šå¯¦éš›ç¨‹å¼ç¢¼ï¼Œç¦æ­¢ä½¿ç”¨ ... çœç•¥]
public override void OnActionExecuting(ActionExecutingContext context)
{
    // æª¢æŸ¥æ¢ä»¶
    if (!isValid)
    {
        context.Result = new JsonResult(new { error = "..." });
        return;
    }
    
    base.OnActionExecuting(context);
}
```

**æ””æˆªè™•ç†ï¼š**
- **é©—è­‰1**ï¼š[å¾…è£œå……]
- **é©—è­‰2**ï¼š[å¾…è£œå……]

---

### 5.2 å›žæ‡‰ä¿®æ”¹

[å¾…è£œå……ï¼šèªªæ˜Žå›žæ‡‰ä¿®æ”¹é‚è¼¯]

**ä¿®æ”¹é‚è¼¯ï¼š**
```csharp
// [å¾…è£œå……ï¼šè²¼ä¸Šå¯¦éš›ç¨‹å¼ç¢¼ï¼Œç¦æ­¢ä½¿ç”¨ ... çœç•¥]
public override void OnActionExecuted(ActionExecutedContext context)
{
    if (context.Result is JsonResult result)
    {
        // ä¿®æ”¹å›žæ‡‰å…§å®¹
    }
    
    base.OnActionExecuted(context);
}
```

---

### 5.3 æ¨™é ­è™•ç†

**è«‹æ±‚æ¨™é ­è®€å–ï¼š**
```csharp
var header = context.HttpContext.Request.Headers["HeaderName"];
```

**å›žæ‡‰æ¨™é ­è¨­å®šï¼š**
```csharp
context.HttpContext.Response.Headers.Add("HeaderName", "Value");
```

---

## 6. ä½¿ç”¨ç¯„ä¾‹ (Usage Examples)

### 6.1 åŸºæœ¬ä½¿ç”¨

```csharp
// å¥—ç”¨åœ¨ Controller
[PipelineName(Order = 1)]
public class MyController : Controller
{
    // ...
}
```

---

### 6.2 å¥—ç”¨åœ¨ Action

```csharp
// å¥—ç”¨åœ¨ç‰¹å®š Action
[PipelineName]
public ActionResult MyAction()
{
    // ...
}
```

---

### 6.3 çµ„åˆä½¿ç”¨

```csharp
// å¤šå€‹ Pipeline çµ„åˆ
[Pipeline1(Order = 1)]
[Pipeline2(Order = 2)]
[Pipeline3(Order = 3)]
public class MyController : Controller
{
    // ...
}
```

---

## 7. æž¶æ§‹èˆ‡å“è³ªåˆ†æž (Architecture & Quality Analysis)

### 7.1 æ•ˆèƒ½å½±éŸ¿è©•ä¼°

**æ•ˆèƒ½å½±éŸ¿ï¼š**
- **åŸ·è¡Œæ™‚é–“**ï¼š[å¾…è£œå……ï¼šå¹³å‡åŸ·è¡Œæ™‚é–“]
- **è³‡æºæ¶ˆè€—**ï¼š[å¾…è£œå……ï¼šCPU/è¨˜æ†¶é«”ä½¿ç”¨]

**æ•ˆèƒ½æª¢æŸ¥æ¸…å–®ï¼š**
- [ ] é¿å…é‡è¤‡è¨ˆç®—
- [ ] å¿«å–å¸¸ç”¨è³‡æ–™
- [ ] éžåŒæ­¥è™•ç†ï¼ˆå¦‚é©ç”¨ï¼‰
- [ ] é¿å…é˜»å¡žæ“ä½œ

---

### 7.2 å®‰å…¨æ€§æª¢æŸ¥

**å®‰å…¨è²¬ä»»ï¼š**
[å¾…è£œå……ï¼šæ­¤ Pipeline åœ¨å®‰å…¨æ€§æ–¹é¢çš„è²¬ä»»]

**å®‰å…¨æª¢æŸ¥æ¸…å–®ï¼š**
- [ ] è¼¸å…¥é©—è­‰
- [ ] æŽˆæ¬Šæª¢æŸ¥
- [ ] SQL æ³¨å…¥é˜²è­·
- [ ] XSS é˜²è­·
- [ ] CSRF é˜²è­·

**å®‰å…¨é¢¨éšªï¼š**
- [å¾…è£œå……ï¼šå·²è­˜åˆ¥çš„å®‰å…¨é¢¨éšª]

---

### 7.3 éŒ¯èª¤è™•ç†

**éŒ¯èª¤è™•ç†ç­–ç•¥ï¼š**
```csharp
try
{
    // Pipeline é‚è¼¯
}
catch (Exception ex)
{
    // éŒ¯èª¤è™•ç†
    logger.Error(ex);
    context.Result = new JsonResult(new { error = "..." });
}
```

**éŒ¯èª¤é¡žåž‹ï¼š**
- `ExceptionType1` - [å¾…è£œå……ï¼šè™•ç†æ–¹å¼]
- `ExceptionType2` - [å¾…è£œå……ï¼šè™•ç†æ–¹å¼]

---

### 7.4 æ—¥èªŒè¨˜éŒ„

**æ—¥èªŒç­–ç•¥ï¼š**
- **è¨˜éŒ„æ™‚æ©Ÿ**ï¼š[å¾…è£œå……ï¼šä½•æ™‚è¨˜éŒ„æ—¥èªŒ]
- **æ—¥èªŒç­‰ç´š**ï¼šDebug / Info / Warning / Error
- **è¨˜éŒ„å…§å®¹**ï¼š[å¾…è£œå……ï¼šè¨˜éŒ„å“ªäº›è³‡è¨Š]

**æ—¥èªŒç¯„ä¾‹ï¼š**
```csharp
logger.Info($"Pipeline executed: {pipelineName}");
```

---

## 8. ðŸ“‹ å“è³ªæª¢æŸ¥æ¸…å–® (Quality Checklist)

### â­ åŸºç¤Žæ¡†æž¶ç´š (Foundation Level)
- [ ] **1.1 ðŸ“‚ åˆ†æžæª”æ¡ˆè³‡è¨Š**ï¼šåˆ†æžçš„æª”æ¡ˆè·¯å¾‘å·²å¡«å¯«ã€‚
- [ ] **3.1 å…ƒä»¶å®šç¾©**ï¼šPipeline å…ƒä»¶çš„åŸºæœ¬è³‡è¨Šå·²å®šç¾©ã€‚
- [ ] **3.2 è¨»å†Šæ–¹å¼èˆ‡é †åº**ï¼šè¨»å†Šæ–¹å¼èˆ‡åŸ·è¡Œé †åºå·²èªªæ˜Žã€‚
- [ ] **3.3 é©ç”¨ç¯„åœ**ï¼šå…ƒä»¶çš„é©ç”¨ç¯„åœå·²é—¡è¿°ã€‚

### â­â­ æ ¸å¿ƒé‚è¼¯ç´š (Core Logic Level)
- [ ] **4.1 è§¸ç™¼æ¢ä»¶**ï¼šPipeline çš„è§¸ç™¼æ¢ä»¶å·²å®šç¾©ã€‚
- [ ] **4.2 è™•ç†æµç¨‹**ï¼šMermaid æµç¨‹åœ–å·²ç¹ªè£½ï¼Œä¸”é—œéµæ±ºç­–é»žå·²èªªæ˜Žã€‚
- [ ] **4.3 çŸ­è·¯é‚è¼¯**ï¼šçŸ­è·¯æ¢ä»¶èˆ‡å›žæ‡‰æ–¹å¼å·²é—¡è¿°ã€‚
- [ ] **5.1 è«‹æ±‚æ””æˆª**ï¼šè«‹æ±‚æ””æˆªçš„å®Œæ•´ç¨‹å¼ç¢¼èˆ‡è™•ç†é‚è¼¯å·²æä¾›ã€‚

### â­â­â­ æ•´åˆåˆ†æžç´š (Integration Analysis Level)
- [ ] **1.2 ðŸ“¦ ä¾è³´é—œä¿‚**ï¼šä¾è³´é—œä¿‚è¡¨å·²å®Œæ•´å¡«å¯«ã€‚
- [ ] **6. ä½¿ç”¨ç¯„ä¾‹**ï¼šåœ¨ Controllerã€Action ç­‰ä¸åŒå±¤ç´šçš„ä½¿ç”¨ç¯„ä¾‹å·²æä¾›ã€‚
- [ ] **7.1 æ•ˆèƒ½å½±éŸ¿è©•ä¼°**ï¼šæ•ˆèƒ½æª¢æŸ¥æ¸…å–®å·²å®Œæˆè©•ä¼°ã€‚
- [ ] **7.2 å®‰å…¨æ€§æª¢æŸ¥**ï¼šå®‰å…¨è²¬ä»»èˆ‡å®‰å…¨æ€§æª¢æŸ¥æ¸…å–®å·²å®Œæˆè©•ä¼°ã€‚
- [ ] **7.3 éŒ¯èª¤è™•ç†**ï¼šéŒ¯èª¤è™•ç†ç­–ç•¥èˆ‡ç¨‹å¼ç¢¼ç¯„ä¾‹å·²æä¾›ã€‚

### â­â­â­â­â­ åŠŸèƒ½å¯¦ä½œå®Œæ•´åˆ†æž (Full Implementation Analysis)
- [ ] **å®Œæ•´æ€§**ï¼šæ–‡ä»¶å…§æ‰€æœ‰ `[å¾…è£œå……]` æ¨™è¨˜çš†å·²ç§»é™¤ï¼Œä¸¦æ›¿æ›ç‚ºåŸºæ–¼åŽŸå§‹ç¢¼çš„çœŸå¯¦åˆ†æžå…§å®¹ã€‚
- [ ] **ç¨‹å¼ç¢¼çœŸå¯¦æ€§**ï¼šæ‰€æœ‰ç¨‹å¼ç¢¼ç‰‡æ®µçš†ç‚ºå°ˆæ¡ˆä¸­çš„**å¯¦éš›ç¨‹å¼ç¢¼**ï¼Œ**é€å­—è¤‡è£½**ï¼Œç„¡ä»»ä½•çœç•¥æˆ–ç·¨é€ ã€‚
- [ ] **æµç¨‹åœ–çœŸå¯¦æ€§**ï¼šæ‰€æœ‰ Mermaid åœ–è¡¨ä¸­çš„å…ƒç´ ï¼ˆå‡½å¼åã€é¡žåˆ¥åã€æµç¨‹æ­¥é©Ÿï¼‰çš†èƒ½åœ¨åŽŸå§‹ç¢¼ä¸­æ‰¾åˆ°æ˜Žç¢ºå°æ‡‰ã€‚
- [ ] **ç„¡æŽ¨æ¸¬æ€§å…§å®¹**ï¼šæ–‡ä»¶ä¸­æ‰€æœ‰åˆ†æžå…§å®¹çš†åŸºæ–¼**å·²æä¾›çš„åŽŸå§‹ç¢¼æª”æ¡ˆ**ï¼Œç„¡ä»»ä½•åŸºæ–¼æŽ¨æ¸¬çš„å…§å®¹ã€‚
- [ ] **ä¾è³´é—œä¿‚æœ€çµ‚ç¢ºèª**ï¼š`1.2 ðŸ“¦ ä¾è³´é—œä¿‚` è¡¨ä¸­çš„æ‰€æœ‰ä¾è³´é …çš†æœ‰å°æ‡‰çš„åˆ†æžæ–‡ä»¶é€£çµï¼Œä¸”ç„¡æ‡¸ç©ºçš„ä¾è³´ã€‚
- [ ] **å¯é©—è­‰æ€§**ï¼šæ‰€æœ‰åˆ†æžçµæžœçš†å¯é€éŽé–±è®€åŽŸå§‹ç¢¼æª”æ¡ˆé€²è¡Œé©—è­‰ï¼Œç„¡æ³•é©—è­‰çš„å…§å®¹å¿…é ˆæ˜Žç¢ºæ¨™è¨˜ç‚ºã€ŒæŽ¨æ¸¬ã€æˆ–ã€Œå»ºè­°ã€ã€‚

---

> **ðŸŽ¯ åˆ†æžå“è³ª**ï¼šâ­ åŸºç¤Žæ¡†æž¶  
> **ðŸ“… é–‹å§‹æ—¥æœŸ**ï¼š__CURRENT_DATE__  
> **ðŸ“… æœ€å¾Œæ›´æ–°**ï¼š__CURRENT_DATE__  
